using Polynomials

function conductWilsonExperiment(p::Array)
    polynomial = Polynomial(p)

    rroots = roots(polynomial)
    # rroots = sort(rroots)
    k = 1
    for root in rroots
        println("----------------------")
        println("For k=",k)
        println("Root calculated by function roots = ", root)
        println("----------------------")
        println("Comparisons")
        Pzk = polynomial(root)
        println("|P(z_k)| = ", abs(Pzk))
        product = 1
        for i in 20:-1:1
            product *= (root-i)
        end
        println("|p(z_k)| = ", abs(product))
        println("|z_k - k| = ", abs(root-k))
        k+=1
    end    
end  

function main()
    p=[1, -210.0, 20615.0,-1256850.0,
      53327946.0,-1672280820.0, 40171771630.0, -756111184500.0,          
      11310276995381.0, -135585182899530.0,
      1307535010540395.0,     -10142299865511450.0,
      63030812099294896.0,     -311333643161390640.0,
      1206647803780373360.0,     -3599979517947607200.0,
      8037811822645051776.0,      -12870931245150988800.0,
      13803759753640704000.0,      -8752948036761600000.0,
      2432902008176640000.0]
    p = reverse(p)  

    println("-----------------------------------------------------------------")
    println("Wilson experiment part A")
    println("-----------------------------------------------------------------")
    conductWilsonExperiment(p)


    p=[1, -210.0-2^(-23), 20615.0,-1256850.0,
    53327946.0,-1672280820.0, 40171771630.0, -756111184500.0,          
    11310276995381.0, -135585182899530.0,
    1307535010540395.0,     -10142299865511450.0,
    63030812099294896.0,     -311333643161390640.0,
    1206647803780373360.0,     -3599979517947607200.0,
    8037811822645051776.0,      -12870931245150988800.0,
    13803759753640704000.0,      -8752948036761600000.0,
    2432902008176640000.0]
    p = reverse(p)  
    println("-----------------------------------------------------------------")
    println("Wilson experiment part B")
    println("-----------------------------------------------------------------")
    conductWilsonExperiment(p)
end 

main()